steps:
  - name: 'gcr.io/cloud-builders/gcloud'
    entrypoint: 'bash'
    args:
      - '-c'
      - |
        gcloud functions deploy voicemailTranscriber \
          --gen2 \
          --runtime=go121 \
          --entry-point=HandleRequest \
          --trigger-http \
          --allow-unauthenticated \
          --region=europe-west2 \
          --set-env-vars=GCP_PROJECT_ID=voicemail-transcribe-454814,PUBSUB_TOPIC_NAME=projects/voicemail-transcribe-454814/topics/gmail-notifications,EMAIL_RESPONSE_ADDRESS=booking@jakatasalon.co.uk

timeout: 900s